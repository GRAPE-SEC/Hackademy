# 실습 : 컨테이너 두개 만들고 포트포워딩하기

<aside>
💡 author : agamtt 2023-11-30

</aside>

# 도커 컨테이너 포트 포워딩

도커 컨테이너는 실제 컴퓨터 안에 프로그램으로 작동하는 가상의 시뮬레이션 컴퓨터 입니다.

컴퓨터 네트워크로 인터넷 등의 통신을 하려면 네트워크 인터페이스 부품이 필요합니다.

그러나 가상의 컴퓨터인 도커는 실제 부품인 네트워크 인터페이스를 가지고 있지 않습니다.

![Untitled](Untitled%20189.png)

따라서, 도커를 설치한 실제 컴퓨터의 포트와 도커의 포트를 포트 포워딩하여야 도커에서 네트워크 연결을 사용할 수 있습니다.

아래에서 실습해보면서 확인해보겠습니다.

## docker container 두개를 만들고 port forwarding 하기

<aside>
💡 **참고**

컴퓨터 통신을 할 가상의 컴퓨터 두대를 만들기 위하여 컴퓨터 두대를 살 수는 없으니

docker 를 이용하여 두개의 컨테이너를 생성합니다.  

docker container 는 실제 컴퓨터나 다름 없으므로, 실제 서버나 컴퓨터도 동일하게 작동합니다.

docker container 에서 익힌 지식을 서버, 실제 컴퓨터를 해킹하는데에 사용할 수 있습니다. 

</aside>

docker container 를 생성하는, 본인이 가진 실제 컴퓨터를 **호스트(host)** 라고 부릅니다. container 는 container 입니다.

모든 컴퓨터에는 1~65535 개의 port 가 있습니다.

보통 컴퓨터 통신에서는 하나의 중앙 컴퓨터가 여러대의 손님 컴퓨터와 연결되는 경우가 많습니다.

예를들어 네이버를 이용하면 서버는 네이버에 있는 어떤 컴퓨터이고, 손님은 당신의 노트북이나 스마트폰입니다.

이때, 한대의 중앙 컴퓨터를 **서버(server)**, 손님 컴퓨터를 **클라이언트(Client)**라고 부릅니다.

호스트의 터미널을 열고 (Windows 의 경우, cmd 또는 powershell, MacOS의 경우 Terminal 또는 iterm)

다음의 명령어를 실행합니다.

- 컨테이너 두개를 생성하고, 랜덤 이름이 아니라 각각 server, client 로 설정합니다.
- 포트포워딩 설정은 -p 를 입력하고, 스페이스바를 한번 입력하고, 호스트포트번호:컨테이너포트번호 형식으로 입력합니다.
    - 예를 들어, 8001:8001 은 호스트의 8001번 포트와 컨테이너의 8001 포트를 연결했다는 뜻 입니다.
    - 알기 쉽게 호스트와 컨테이너의 포트번호를 동일하게 지정했지만, 다르게 지정하는 것도 가능합니다.

```python
docker run -dit -p 8001:8001 --name server ubuntu
docker run -dit -p 8002:8002 --name client ubuntu
```

그러면 다음과 같이 서버와 클라이언트 역할을 할 컨테이너가 두개 생성됩니다.

![Untitled](Untitled%20197.png)

vscode 를 이용하여 이를 각각 열어줍니다.

Docker 플러그인을 설치한 후 Docker 탭에 들어가서 컨테이너에 우클릭한 후 Attach 하면 됩니다.

![Untitled](Untitled%20198.png)

그러면 아래와 같이 두개의 컨테이너가 vscode 에 각각 Attach 됩니다.

![Untitled](Untitled%20199.png)

Ctrl + ` 를 눌러서 터미널을 엽니다.

이제 각각 창의 vscode 의 터미널은 각 container 의 리눅스 명령어를 실행합니다.

![Untitled](Untitled%20200.png)

호스트의 포트를 통해 외부의 네트워크와 통신할 통로인 포트가 설정된 도커 컨테이너가 두개 만들어 졌습니다.

실제로는 도커를 설치한 여러분의 컴퓨터에서 일어나는 일이지만,

실제 세상에 두개의 다른 컴퓨터가 인터넷에 연결되어있다고 상상해보세요.

이제 실습 준비가 끝났으니, 두개의 컴퓨터를 통신 시켜서 네트워크에 대해 배워봅시다.

계속