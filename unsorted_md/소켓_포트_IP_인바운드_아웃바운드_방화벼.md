# 소켓, 포트, IP, 인바운드, 아웃바운드, 방화벽, 포트포워딩

<aside>
💡 author : agamtt 2023-11-30

</aside>

# 해킹과 네트워크

해커가 직접 해킹할 곳에 걸어서 가서 노트북을 꽂지 않아도 접속할 수 있는 이유는, 컴퓨터끼리 네트워크로 연결되어있기 때문입니다.

컴퓨터 네트워크에 대해 배워봅시다.

컴퓨터 공학 전공인 “컴퓨터 네트워크” 에서, 해킹에 꼭 필요한 부분만 가져왔습니다.

![Untitled](Untitled%20186.png)

# 네트워크

컴퓨터와 컴퓨터는 (놀랍게도) 서로 먼거리에 떨어져있어도 통신을 할 수 있습니다.

컴퓨터 1대와 컴퓨터 1대가 연결되는 것을 컴퓨터 통신 또는 Computer Communication 이라고 부릅니다.

하지만 세상에는 꽤 많은 컴퓨터가 있습니다.

2대 이상의 컴퓨터가 서로 그물(net)처럼 얽혀서 컴퓨터 통신하는 상태를 **컴퓨터 네트워크(Network)**라고 부릅니다.

![Untitled](Untitled%20187.png)

# 인터넷

전세계의 컴퓨터가 네트워크로 연결된 것을 인터넷이라고 부릅니다.

![Untitled](Untitled%20188.png)

## 소켓(Socket)

컴퓨터와 컴퓨터가 통신하려면 네트워크 인터페이스라는 것이 필요합니다.

그것은 이렇게 생긴 부품입니다. 컴퓨터 내부에 장착되어있습니다.

![Untitled](Untitled%20189.png)

당연히 스마트폰에도 장착되어 있습니다.

![Untitled](Untitled%20190.png)

![Untitled](Untitled%20191.png)

코딩으로 만든 프로그램이 이러한 네트워크 인터페이스를 사용하려고 전선을 직접 연결할 수 는 없으니 네트워크 인터페이스를 코드가 사용할 수 있도록 해주는 기능이 존재합니다. 이를 **소켓(Socket)** 이라고 부릅니다.

소켓으로 왔다갔다 하는 전기신호 데이터를 **패킷(Packet**)이라고 부릅니다.

## 포트(port)

포트는 영어로 항구를 뜻하는 말입니다.

공항은 공중 항구의 약자로 비행기가 오고가는 포트(air port) 입니다.

하나의 나라에는 여러개의 공항이 있습니다.

인천공항이 폐쇄되면 인천공항으로 비행기가 오고갈 수 없습니다. 김포공항이 열려있으면 김포공항으로는 비행기가 오고갈 수 있습니다.

컴퓨터의 포트도 동일한 의미로 쓰입니다.

포트가 열려있어야 해당 포트로 통신이 가능합니다.

운영체제는 포트를 열고 닫으면서 통신을 관리합니다.

# 포트번호 (port number)

컴퓨터는 1번 포트부터 6만번 까지의 포트번호를 가지고 있습니다.

컴퓨터 프로그램은 프로세스라는 작은 단위로 실행됩니다.

**프로세스 하나가 포트 하나를 일대일로 사용합니다.**

Google Chrome 처럼 거대한 프로그램은 아주 많은 프로세스를 동시에 사용합니다.

![Untitled](Untitled%20192.png)

Port 는 0~ 65535 의 숫자로, Port 하나는 프로세스 하나에 대응됩니다.

Socket 으로 들어온 패킷은 Port 를 보고 프로세스를 찾아갑니다.

Port 는 이미 다른 프로세스가 쓰고 있는 Port 는 사용할 수 없습니다. 해당 프로세스를 종료한 후 사용할 수 있습니다.

이러한 Port 를 통해 프로세스끼리 헷갈리지 않고 통신이 분리되어서 이루어집니다.

## IP

IP 는 아이피주소라고도 부릅니다.

컴퓨터 네트워크에서 컴퓨터가 서로를 찾을 수 있게해주는 전화번호 같은 것 입니다.

IP 주소는 인터페이스 당 하나가 부여됩니다.

- 보통, 본체가 있는 데스크톱 컴퓨터의 경우, 랜선을 여러개 꽂을 수 있으므로 2개 이상의 인터페이스와 IP를 가질 수 있습니다.

![Untitled](Untitled%20193.png)

- 스마트폰의 경우 와이파이 인터페이스만 가지고, 랜선을 유선으로 연결할 수 없으므로 보통 인터페이스는 한개 입니다. 따라서 IP도 하나만 가집니다.

![Untitled](Untitled%20194.png)

# IP 와 Port

**두대의 컴퓨터가 서로 통신하려면 IP주소와 Port 번호가 필요합니다.**

우선 IP 로 인터넷 상에서 컴퓨터를 찾습니다. 마치 전화번호로 휴대폰을 찾는 것 처럼요.

컴퓨터를 찾고 나면 해당 컴퓨터에서 port 로 프로세스를 찾습니다.

그리고 나면 통신이 이루어집니다.

대부분의 프로그램은 콜론(: 기호) 로 IP 와 Port 를 구분합니다.

아래는 210.10.94.277 이라는 IP 주소의 8082 포트와 연결된 프로세스를 뜻하는 표현입니다.

```bash
210.10.94.277:8082
```

# 포트의 아웃바운드, 인바운드 연결, 방화벽

운영체제는 포트를 열고 닫으면서 연결을 관리합니다.

포트가 닫혀있으면 해당 포트로 다른 컴퓨터와 연결될 수 없습니다.

**아웃바운드(outbound) 는 포트의 외부로부터 들어오는 연결 요청을 말합니다.
인바운드(inbound) 는 포트의 내부로부터 외부로 나가는 연결 요청을 말합니다.**

이것을 나누는 이유는 주로 보안 때문입니다. 모든 포트를 열어두고 외부로부터 오는 모든 신호를 받아들이면 편리하겠지만, 악성코드나 디도스 공격에 무방비로 노출됩니다.

운영체제는 이것을 나누어서 관리할 수 있습니다. 포트들의 아웃바운드와 인바운드 연결을 관리하는 운영체제의 기능을 **방화벽(firewall)** 이라고 부릅니다.

방화벽을 통 포트 하나에 대한 아웃바운드와 인바운드를 각각 따로 따로 허용/차단 설정할 수 있습니다.

### Windows 방화벽

![Untitled](Untitled%20195.png)

### Ubuntu 리눅스의 Ubuntu FireWall (ufw) 방화벽

![Untitled](Untitled%20196.png)

# 포트 포워딩(Port Forwarding)

포워딩(Forwarding) 은 영어로 “전달하다” 라는 뜻 입니다.

포트 포워딩(Port Forwarding) 은 두개의 포트를 연결하는 것을 말합니다.

두개의 포트가 포트 포워딩 되어있으면, 두개의 포트가 서로 연결된 것 처럼 동작합니다.

포트포워딩은 콜론(: 기호)로 구분해서 표현합니다.

아래 표현은 8080 포트와 2988 포트가 포트 포워딩 된 것을 의미합니다.

8080 포트로 들어오는 요청은 2988 포트로 나가고,

2988 포트로 들어오는 요청은 8080 포트로 나갑니다.

```bash
8080:2988
```

포트포워딩은 운영체제에 의해 관리됩니다.

계속