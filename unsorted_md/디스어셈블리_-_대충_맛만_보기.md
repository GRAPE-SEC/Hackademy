# 디스어셈블리 - 대충 맛만 보기

이 복잡스러운 화면은, Binary Ninja 가 실행파일을 열어서 분석한 것 입니다.

![image.png](image%2033.png)

바이너리 실행파일은 사실, **컴퓨터에서 실행되기 위하여 기계어 (0101011101 이런거) 가 적힌 긴 텍스트일 뿐**입니다. 잘 구분해서 규칙에 따라 읽으면 읽을 수 있습니다.

리버싱 도구들은 그냥 바이너리 실행파일의 내용을, 컴퓨터의 실행 규칙에 따라 잘 정리해서 보여주는 프로그램입니다.

# 디스어셈블리

리버싱툴을 사용하면 바이너리 파일로 부터 읽은 데이터를 다양한 형식으로 정리해서 확인할 수 있습니다. 

- Disassembly 는 바이너리를 **어셈블리어** 형식으로 출력합니다
- Low Level IL, Medium Level IL, High Level IL 은 중간언어라는 건데, 당장은 몰라도 됩니다.
- Pseudo C 는 바이너리를 잘 분석해서 원래 C언어로 비슷하게 추측해서 출력하는 기능입니다. 다만, 추측이므로 틀릴 수 있습니다. 디컴파일(Decompile) 이라고도 부릅니다.

![image.png](image%2034.png)

# 클로즈드 소스(Closed Source)

대부분의 프로그램은 소스코드, 그러니까 그 프로그램을 만드는데에 쓴 코드를 외부에 알려주지 않고, 회사 내부에만 보관합니다.

예를 들어, Windows 나 아이폰의 코드를 인터넷에서 다운받을 수 없습니다.

이런 코드를 클로즈드 소스(Closed Source) 라고 부릅니다.

반대로 인터넷에 올라와있어서 누구나 다운받고 확인할 수 있는 코드는 오픈소스(Open Source) 라고 부릅니다.

오픈소스인 경우에는 코드를 보고 분석하면 됩니다. 이렇게 리버싱을 할 필요가 거의 없습니다.

단, 클로즈드 소스인 경우**, 코드가 없기 때문에** 리버싱을 해서 코드를 알아내는 것 입니다.

# main 함수 찾기

우리가 게임을 만들때, 게임이 실행되면 제일 먼저 **main 함수가 실행**되도록 만들었습니다.

이렇게, 어떤 프로그램이 실행될때 제일 먼저 시작되는 부분을 **엔트리포인트(Entrypoint)** 라고 부릅니다.
C언어로 만든 프로그램은 대부분 엔트리포인트가 main 이라는 이름의 함수입니다.

![image.png](image%2035.png)

실행되는 곳 부터 흐름을 따라가면서 어떻게 작동하는지 파악하는 것이 편할테니,

이 main 을 Binary Ninja 에서 찾아봅시다.

그냥 스크롤 내리면서 찾아도 되는데, symbol 을 통해 찾는 것이 더 편합니다

# Symbols

바이너리 파일 안에 메모되어있는 함수의 이름 등의 정보를 **심볼(Symbol)** 이라고 합니다.

#모양 버튼을 누르면 Symbols 라는 창이 켜졌다 꺼졌다 합니다. 여기서 바이너리 파일의 심볼들을 확인할 수 있습니다

거기서 main 을 찾으면 긴 바이너리 중 main 함수의 위치로 이동할 수 있습니다.

![image.png](image%2036.png)

# 프로그램은 위에서 아래로 한줄 한줄 실행된다.

컴퓨터의 위에서 아래로 코드를 실행시킵니다.

사실 코드가 실행되는 순서를 위 라고 정한것같긴한데 암튼요

![image.png](image%2037.png)

이 사진에 나온 정보를 해석해보면 아래와 같습니다.

왼쪽의 초록글씨는 **몇번째줄에 있는지 줄 수**를 16진법으로 쓴 것 입니다. 그니까 행 입니다. 

![image.png](image%2038.png)

가운데는 실제로 읽은 바이너리를 16진법으로 표현한 것 입니다.

![image.png](image%2039.png)

즉, Hex Editor 로 바이너리를 직접 열었을때 보이던 16진수 Hex 값인 아래 이거랑 정확히 동일합니다.

![image.png](image%2040.png)

제일 오른쪽에 있는게 이 Hex 를 어셈블리어로 번역한 것 입니다.

![image.png](image%2041.png)

예를 들어, 0000126f 줄에 있는 55 는 push rbp 라는 명령을 CPU 에게 실행하게 합니다.

지금 당장 push rbp 가 뭔지 몰라도 됩니다. 그런게 있나보다 하는거죠

자세한 내용은 이것이 어떻게 실행되는지 알아야하니, 일단 패스합시다

아래의 내용만 기억하면 됩니다.

## 이번 강의에서 기억해야하는 내용

- 실행파일은 사실 걍 텍스트같은 데이터 쪼가리다.
- Hex Editor 로 그냥 열면 16진수로 읽을 수 있다
- 리버싱 툴이 있으면 좀 더 쉽게 Hex 를 읽을 수 있다.
- 이 Hex 데이터들은 컴퓨터에서 한줄한줄 실행된다.

계속…