# 취약점 찾기와 exploit(익스플로잇), 임의코드실행

# 임의코드실행(ACE), 원격임의코드실행(RCE)

만약 해킹당했을때,

해커가 무엇을 할 수 있는지에 따라 취약점을 분류합니다.

그 중, 임의 코드 실행(ACE, Arbitrary Code Execution Vulnerability) 은 해커가 맘대로 피해자의 컴퓨터에서 자기가 원하는 아무 코드나 실행할 수 있는 것을 의미합니다.

임의코드실행 취약점 중, 그걸 원격으로 할 수 있으면 Remote Arbitrary Code Execution Vulnerability, RCE (원격임의코드실행 취약점) 라고 부릅니다.

일반적으로 알려진 통념과 달리, RCE 취약점이 있으면 악성코드나 바이너스를 설치하거나 의심스러운 파일을 실행하는 **잘못된 실수 없이도 그냥 컴퓨터를 원격으로 해킹할 수 있습니다**.

# 메모리 취약점 찾기의 어려움

photoDot.c 는 함수 두개짜리 아주 짧은 코드입니다.

그러나 실제 소프트웨어는 매우 복잡하며, 코드도 아주 깁니다.

- 여러개의 프로그래밍 언어로 된 코드가 같이 작동할 수도 있습니다.
- 소스코드가 몇십만줄씩 됩니다.
- 어떤 데이터가 여러개의 버퍼와 함수를 통과합니다.

이런 상황에서, 어떤 메모리에서 어떤 취약점이 발생하는지 찾기는 아주 어렵습니다.

거대한 소프트웨어 일수록, 아직 아무도 발견하지 못한 메모리 취약점이 있을 수 있습니다.

## 제로데이 취약점

어떤 취약점은 아무도 모르는 상태입니다. 아무도 발견하지 못했으며, 발견하는 사람은 **아무도 막지 못하는 해킹 공격**을 할 수 있습니다.

많은 경우, 제로데이 공격을 막는 방법은 **취약점을 미리 찾아서 막는 것** 말고는 별로 대책이 없는 경우가 많습니다.

제로데이 공격을 쓰는 해커는 공격을 한번 쓰고 나면, 해킹이 되었음을 제조사나 보안 전문가 등이 알 수 있습니다. 그러면 해당 취약점은 더이상 쓸 수 없도록 보안 업데이트됩니다. 

따라서 제로데이는 일종의 한번만 쓸 수 있는 필살기같은 것인 셈입니다.

유명한 프로그램이나 시스템의 제로데이 취약점은 베일에 꽁꽁 감춰져있으며, 다크웹이나 암시장에서 몰래 거래됩니다. 때로는 몇억에서 몇십억까지 하는 경우도 있습니다.  싯가죠

취약점(Vulnerability) 을 이용해서 실제로 시스템에 침투해서 뭔가 악성행위를 수행하는 것을 Exploit 이라고 부릅니다.

## 메모리 취약점을 자동으로 찾으려는 시도 - Fuzzer

소스코드가 몇십만줄이면 메모리 취약점을 눈으로 찾는 것은 아주 어렵습니다.

Fuzzer 란, 메모리 취약점을 자동으로 찾아주는 프로그램입니다.

프로그램에 넣을 수 있는 입력들 (텍스트, 이미지를 비롯한 각종 데이터) 또는 프로그램에서 실행시킬 수 있는 코드 등을 무작위로 생성해서, 발생하는 오류를 탐지합니다. 무작위 데이터를 입력하는 것을 Fuzzing 이라고 부릅니다.

오류가 발생하고 나면, 그 부분을 집중적으로 분석해서 메모리 취약점을 찾을 가능성을 높입니다.

Fuzzer 를 이용한 Fuzzing 은 아직도 활발히 연구되고 있습니다. 관련 논문이 계속 나옵니다

*여기에서는 다루지 않겠습니다.

## poc(proof of concept, 개념증명)

보안전문가나 프로그래머들이 프로그램의 취약점을 고칠때, 해킹을 실제로 해보고 해당 부분을 수정해야하는 경우, 취약점을 직접 발동 시켜봐야하는 경우가 있습니다.

 

실제로 집어넣으면 해킹이 가능한 어떤 데이터나 소스코드를 “실제로 해킹이 가능함을 보이는” 라는 뜻에서 PoC 라고 부릅니다.

## 버그 패치, 보안 업데이트

취약점을 보안 전문가나 화이트해커가 미리 발견하거나, 블랙 해커에게 해킹을 당한 뒤에 제조사는 해당 취약점을 더이상 악용할 수 없도록 수정한 프로그램을 다시 배포합니다.

이것을 보안 패치 또는 보안 업데이트라고 부릅니다 

![image.png](image%20156.png)

## 1-day 취약점

제로데이 취약점이 이미 알려진 경우, 이를 1-day 취약점이라고 부릅니다.

이미 어떤 취약점인지 알려졌지만, 보안 패치가 아직 되지 않았거나, 사용자가 업데이트 하지 않은 경우, 여전히 해당 취약점을 exploit 할 수 있습니다.

자주 보안 업데이트를 하라는 말이 사실 이런 의미입니다.

하지만 사실 사용자들은 알빠노 하고 업데이트 걍 무시하기 때문에 해킹에 당하는 경우가 있습니다

예를 들어, 이미지 편집 프로그램인 **알씨**는 Windows 에서 널리 사용되는데, 9.31 버전을 사용하는 사람들은 특별하게 (해커가) 제작한 이미지를 알씨로 열면 알씨의 메모리가 손상되면서 Windows 에서 임의코드가 실행될 수 있습니다.

해커들은 악성 이미지를 인터넷 게시판 등에 뿌려놓고 누군가 알씨를 쓰는 사용자가 다운로드 받기를 기다리거나, 알씨를 쓰는 것으로 알려진 기업 사무실 이메일로 이미지파일이 담긴 메일을 보냅니다

알씨로 이 파일을 열면 이런일이 보통 일어나죠

- 모든 폴더에 있는 파일을 암호화한다음 돈을 요구함 (랜섬웨어)
- 중요한 파일들을 외부로 빼돌림
- 언제든 다시 접속할 수 있게 백도어를 심음
- 회사의 내부망으로 들어갈 수 있는 비밀번호나 접속정보를 훔쳐가서 회사 네트워크를 해킹
- 컴퓨터와 연결된 컴퓨터나 스마트폰을 또 해킹

메모리 취약점이 종류별로 뷔페처럼 있습니다 정말 레전드죠(*비하 의도 없음)

![image.png](image%20157.png)

계속…