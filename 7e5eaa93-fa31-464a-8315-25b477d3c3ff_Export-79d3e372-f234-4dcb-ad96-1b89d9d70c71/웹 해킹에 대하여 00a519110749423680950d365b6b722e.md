# 웹 해킹에 대하여

여태껏 다룬 해킹은 바이너리 실행파일에 관한 것이였습니다.

포너블 : 컴퓨터에서 실행되는 프로그램은 바이너리 실행파일을 실행하여 작동합니다. 사람들이 쓰는 프로그램을 분석해보고 취약점이 존재한다면, 똑같은 프로그램을 쓰는 사람들의 프로그램을 해킹할 수 있습니다

게임핵 : 게임을 다운받으면 데스크톱이나 스마트폰에서 실행됩니다. 이 실행되는 파일은 바이너리 실행파일이므로, 리버싱으로 기계어 코드를 볼 수 있습니다. 이걸 바꿔서 나쁜짓을 합니다. 체력이나 공격력, 가진 돈의 액수 등을 바꾸거나 자동조준기능을 추가합니다.

그러나 웹해킹은 다른 차원의 얘기입니다

웹이라는, 이미 널리 쓰이고 잘 만들어진 시스템에 대한 전반적인 취약점에 대해 다룹니다.

물론 웹도 어디선가 컴퓨터에서 바이너리 실행파일이 실행되는 것이지만, 웹해킹은 그 실행파일에 나쁜짓을 하는게 아니라, 웹이 서로 유기적으로 작동하는 기능상의 버그나 미흡한 보안을 악용합니다.

(물론 웹을 이루는 실행파일들도 취약점이 존재할 수 있으나, 그건 웹해킹이 아니라 바이너리 해킹으로 분류됩니다)

# 웹

웹은 아래와 같은 것들로 구성됩니다

- 브라우저
- 웹서버
- 프론트엔드
- 백엔드

이 요소들이 인터넷으로 통신하는 것이 웹입니다

사실상 인간이 컴퓨터를 쓰는 대부분의 목적에 해당하는 기능을 다 포함하고 있기때문에 10년전부터 폭발적으로 쓰이기 시작해서 2024년에는 지구인 대부분이 사용합니다

유튜브, 네이버, 구글검색, 노션, 싸이월드, 넷플릭스

그리고 웹의 통신 규약만 지키면 프론트엔드가 브라우저건 브라우저가 아닌 어떤 앱이건 신경쓰지 않습니다. 그래서 스마트폰 앱을 프론트엔드로 하고 백엔드 서버를 리눅스로 하는 웹이 아주 널리 쓰이게 되었습니다. 웹과 인터넷 없이 스마트폰은 거의 깡통에 가깝습니다

게다가 프론트엔드를 코딩하는 프론트엔드 개발은 난이도 낮아서 4개월 정도 배우면 그럴싸한 프론트엔드 뚝딱입니다.

Google 이나 Microsoft 의 천재 개발자들이 프론트엔드 코드를 작동시키는 브라우저를 미리 만들어놓은 덕분입니다. 

프론트엔드 개발자가 할 일은 디자인이나 백엔드에 맞는 통신 코딩하기 정도 뿐입니다.

![image.png](image%20172.png)

그리고 브라우저는 모든 기기의 버전이 이미 다 만들어져있기 때문에, 회사 입장에서는 모든 기기마다 다 다른 실행파일 바이너리를 만들기 위해 개발자를 다 따로 고용할 필요가 없으니 좋죠

게다가 프로그램의 핵심로직을 바꾸기 위해 패치를 배포하고

이런 장점 때문에 웹은 지구를 점령했습니다

![image.png](image%20173.png)

# 하이브리드 앱

하이브리드앱은 약간 괴상한 혼종인데,

웹 프론트엔드의 런타임을 올리고 그 위에서 프론트엔드 코드들이 작동하는 실행파일로 앱을 만든 것 입니다.

프론트엔드를 브라우저가 아니라 앱으로 만들면 어떨까 하는 아이디어에서 출발해서 스마트폰에서 주로 쓰입니다.

데스크톱 프로그램 중에서도 하이브리드앱이 많습니다. 예를 들어 vscode 나 discord 등이 하이브리드앱입니다

장점은 다양한 기기에서 코드 수정없이 잘 작동합니다. 웹 런타임은 기기마다 누가 이미 만들어놨으니 프론트엔드 코드만 짜면 됩니다

프론트엔드 개발자는 저렴한 가격에 구할 수 있으니 개발비도 절감되고 참 좋습니다

단점은 느리다는건데 런타임 위에서 작동하는거라 그렇습니다. 게다가 런타임이 제공하지않는 기능은 못쓰니 복잡한 그래픽을 처리해야하는 앱이나 빨라야되는 게임같은건 거의 못만듭니다

주로 sns 처럼 웹과 앱 프론트엔드를 둘다 만들어야되고 사진이랑 텍스트 같은것만 처리하면 되는 가벼운 앱들이 하이브리드앱으로 만들어집니다.

Twitter, Discord, Pinterest 등이 하이브리드앱입니다

React Native 나 Electron 같은 기술을 통해 만들어집니다. 무료고 인터넷에서 다운받을수있고 유튜브에 강의도 많죠

# 웹 취약점

웹은 처음부터 제대로 완벽하게 설계하고 만든게 아니라는 점이 꽤나 문제입니다

빠르게 발전한 기술이여서 만들면서 이쪽 저쪽 뗌빵해가면서 만들었습니다.

그래서 이를 악용한 해커들이 온갖 패악질을 해왔고, 그 공격을 막기 위한 방어 방법들이 웹의 각 요소에 붙기 시작했습니다

(지금도 현재진행중인 얘기입니다.)

웹해킹으로 세상을 엿먹인 유명한 해커들은 룰즈섹, 어나니머스 등 다양합니다. 게다가 웹은 인터넷으로 누구나 접속할 수 있으니, 해킹 당했다는걸 대문짝 만하게 알 수 있어서 아주 좋은 타겟이였습니다. 대다수가 감빵에 갔지만…

# 쿠키

[https://hongong.hanbit.co.kr/완벽-정리-쿠키-세션-토큰-캐시-그리고-cdn/](https://hongong.hanbit.co.kr/%EC%99%84%EB%B2%BD-%EC%A0%95%EB%A6%AC-%EC%BF%A0%ED%82%A4-%EC%84%B8%EC%85%98-%ED%86%A0%ED%81%B0-%EC%BA%90%EC%8B%9C-%EA%B7%B8%EB%A6%AC%EA%B3%A0-cdn/)

쿠키는 웹브라우저의 변수입니다. 코딩을 할때 선언하고 값을 저장하는 변수처럼, 브라우저 실행파일이 실행될때 브라우저가 쓰는 메모리에 저장됩니다.

쿠키는 브라우저 안에서만 쓸 수 있는 변수인거죠

다만 차이가 있다면 쿠키는 주로 백엔드가 설정합니다

정확히는 백엔드가 설정하라는 명령을 보내서 브라우저가 선언하도록 시킵니다. 나중에 직접 만들어보면 무슨 말인지 알 수 있습니다

![image.png](image%20174.png)

![image.png](image%20175.png)

![image.png](image%20176.png)

# 세션쿠키

쿠키를 보안 인증 목적으로 쓰는 경우, 특별히 세션이라고 부릅니다. 세션은 인터넷 상에서 나를 증명하는 신분증 같은것으로, 누군가 세션을 훔치면 웹에서 나인 행세를 할 수 있습니다. 보통 웹사이트 별로 세션을 따로 발급합니다

## 로그인과 세션쿠키

보통, 아이디 패스워드를 입력해서 로그인을 합니다.

그러면, 웹브라우저와 웹서버 간에 이런 일이 일어납니다

![image.png](image%20177.png)

![image.png](image%20178.png)

# 데이터베이스, DB

데이터베이스는 백엔드 역할을 하는 서버 컴퓨터에서 실행되는 프로그램으로, 웹에서 매우 큰 데이터를 체계적으로 관리하는데에 씁니다.

데이터베이스는 엄연히 바이너리 실행파일입니다. 보통 백엔드 역할을 하는 리눅스가 설치된 컴퓨터에서 백그라운드에서 항상 실행됩니다

컴퓨터공학과에서 배우는 정렬, 탐색 등의 알고리즘이 아주 복잡하게 구현되어있어서 데이터를 빠르게 저장하고 검색할 수 있습니다

데이터베이스는 웹 서버 애플리케이션과 통신하면서 데이터를 검색하고 저장합니다. 저장된 데이터는 파일로 보통 저장합니다. 이걸 db 파일이라고 보통 부릅니다

회사의 데이터베이스에는 고객정보, 개인정보, 기밀, 온갖 문서가 저장되어있기때문에 db 파일을 훔쳐지는 경우 심각한 문제가 발생할 수 있습니다. 보통 디비 털렸다고 많이들 부르죠

# 브라우저

브라우저는 스마트폰이나 노트북, 데스크톱 컴퓨터에 설치되는 프로그램입니다.

거의 모든 일반인이 쓰는 컴퓨터용 버전이 시중에 나와있고 종류도 매우 많습니다.

주로 일반인이 웹서버에 접속하기 위해서 사용합니다

아주 예전에는 Explorer 라는 마이크로소프트가 만든 쓰레기 프로그램이 브라우저 시장을 독점하고 있었는데 하도 해킹에 취약해서 나가리가 됐습니다.

Flash, Silverlight, ActiveX 같은 해킹에 몹시 취약한 쓰레기들을 잔뜩 포함하고 있었는데 2024년에는 거의 javascript 로 대체가 되었습니다

![image.png](image%20179.png)

![image.png](image%20180.png)

[https://www.youtube.com/watch?v=AD6719_HXkM](https://www.youtube.com/watch?v=AD6719_HXkM)

지금은  Chrome, Edge, Firefox, Brave. Opera, Whale, Puffin 등 다양한 브라우저가 나와있습니다

![image.png](image%20181.png)

브라우저가 웹서버에 접속하면 프론트엔드 코드(html,css,javascript,webAssembly …) 등을 서버에서 브라우저로 다운받습니다. 그리고 그걸 브라우저가 실행시킵니다.

브라우저는 python interpreter 나 jvm 처럼 다른 코드를 실행시킬 수있는 바이너리를 포함하고 있으며 이를 엔진이라고 부릅니다.

![image.png](image%20182.png)

프론트엔드 코드에는 웹서버에 어떤 통신 요청을 보낼지가 코딩되어있으므로 이 코드를 읽어서 엔진이 실행하며, 이 규칙에 맞게 통신하면서 작동합니다

프론트엔드 코드가 웹서버로 보내는 요청을 HTTP Web API 라고 합니다. 줄여서 API 라고 부르는 경우가 많습니다.

# 매크로

웹브라우저가 웹서버와 통신할 수 있는 대표적인 방법이지만, **웹브라우저만 웹서버와 통신이 가능한 것은 아닙니다.** 그냥 통신 규칙만 지키면 어떤 프로그램이던 웹서버와 통신할 수 있습니다.

그렇기 때문에, 자동 프로그램을 만들어서 인간보다 더 빠르게 웹 통신을 할 수 있습니다.

빠를 수록 이득인 경우, 자동 프로그램을 만들어서 이익을 보려는 것을 **매크로(Macro)**라고 부릅니다.

티켓 구매, 수강 신청 등을 웹으로 구현한 곳이 많습니다.

이를 방어하기 위해 Captcha, 로봇이 아닙니다 같은 것들이 나중에 등장했습니다.

그러나 요즘 AI 에게 뚫리기 때문에 더 어려운 로봇이 아닙니다를 구현하는 것 말고는 딱히 완벽한 방어방법이 나오지 않았습니다.

![image.png](image%20183.png)

![image.png](image%20184.png)

![image.png](image%20185.png)

# 프론트엔드의 취약점 : XSS(Cross Site Scripting)

프론트엔드에서 종종 발견되는 대표적인 취약점 중 하나는 XSS 가 있습니다.

웹브라우저의 엔진은 웹서버로 부터 프론트엔드코드들을 다운받습니다. 이때 동일한 웹서버를 이용하는 유저A 가 바꿀 수 있는 데이터가 유저B 의 프론트엔드 코드로 다운받아지는 경우가 아주 많습니다.

예를 들어, 게시판에 유저A가 글을 쓰면 웹서버에 저장되어서 다른사람들 모두 볼 수 있습니다. 유저B 가 접속하면 유저A 가 쓴 글을 포함한 프론트엔드가 유저B의 브라우저에 다운로드 됩니다

큰 문제는 A가 악성코드를 삽입해서 B의 프론트엔드에서 코드를 실행할 수 있는 경우가 있습니다. 이것을 웹서버를 경유(Cross)해서 스크립팅한다고 해서 Cross Site Scripting 이라고 부릅니다.

그게 성공하면 주로 이런일들이 일어날 수 있습니다

- 자바스크립트를 실행시키면 브라우저에 보이는 화면을 조작할 수 있습니다. 가짜 사이트로 바꿔치기해서 비밀번호나 결제 정보같은걸 탈취하거나, 피해자로 사칭하기 이런걸 할 수 있습니다
- 세션 쿠키를 탈취할 수 있습니다. 그러면 아이디 비밀번호 등의 인증없이 남의 계정에 로그인할 수 있습니다
    - 어나니머스, lulzSec 등의 해커들에 의해 일어난 많은 해킹들이 xss 를 통해 관리자 세션을 탈취하는 것으로 일어났습니다.
    - 예를 들어, 문의글 안에 xss 를 일으키는 악성코드를 심어서 관리자가 문의글을 열람하면 관리자의 세션쿠키를 해커의 서버로 전송하도록 한 뒤, 그 세션쿠키로 관리자로 로그인해서 해킹을 하는거죠

![image.png](image%20186.png)

또한, 프론트엔드의 코드가 실행되는 환경이 **브라우저가 아니라 하이브리드 앱이면,** XSS 를 통해 **RCE(Remote Arbitrary Code Execution) 을 할 수 있는 경우**도 있습니다.

디스코드 Windows 용 앱에서, 조작된 사진 파일을 보내서 XSS 를 통해 디스코드 외부로 탈출할 수 있었습니다. (2021년 패치됨)

[https://www.youtube.com/watch?v=xSKE2E6FE1U](https://www.youtube.com/watch?v=xSKE2E6FE1U)