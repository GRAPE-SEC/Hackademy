# 7-1_Session 개념

<aside>
💡 author : 전재호(agamtt) 2024-01-25

</aside>

# Cookie Poisoning Attack

지난번까지 배운 내용은 다음과 같습니다.

- 쿠키는 유저의 브라우저에 저장되어, 페이지가 이동해도 유지되는 변수이다.
- 백앤드의 쿠키 설정 함수로 접속자의 쿠키를 설정할 수 있다.
- 웹에서는 인증 시스템, 각종 기능의 구현을 쿠키로 한다.
- 쿠키는 사용자가 임의로 조작 변조할 수 있다.

여기서, 쿠키를 조작하여 악성행위가 가능한 이유는,

- 쿠키는 사용자가 임의로 조작 변조할 수 있다.

라는 점 때문입니다.

쿠키를 조작할 수 있는 것은 브라우저의 기능이므로 이를 백엔드에서 막는 것은 불가능합니다. 

따라서, **쿠키를 난수화**하거나, 쿠키를 조작하였을때, **조작되었음을 감지하는 기능**이 고안되었습니다.

이 중, **세션(session) 은** 쿠키를 난수화하는 기능입니다.

세션에 대해 배워보고,

고양이 홈페이지의 쿠키 인증 시스템을 **세션 인증 시스템**으로 바꿔봅시다.

이를 통해 세션이 무엇인지 이해해봅시다.

# 난수

난수란, 무작위 숫자, 랜덤값 을 의미합니다.

요컨데 이런거죠.

![Untitled](Untitled%20525.png)

난수는 **인간이 쉽사리 그 생성 규칙을 추측할 수 없는 문자열**을 말합니다.

쉽게 추측할 수 있는 규칙을 사용하면 어떤 일이 발생하는지 Brute Force Attack 에서 확인한 바 있습니다.

# Session

<aside>
💡

Session 은 사용자가 접속하였을때, 난수화된 값을 생성하여, 하나는 브라우저에 쿠키로 저장하고, 하나는 서버에 저장한 후 둘을 비교하는 보안 기능을 말합니다.

</aside>

세션은 쿠키에서 한단계 발전한 보안 기능입니다.

세션을 쉽게 설명하면 아래와 같습니다.

- 세션은 세션쿠키(Session Cookie) 와 세션파일(Session File) 로 구성됩니다.
- 세션쿠키와 세션파일은 열쇠와 자물쇠처럼 짝을 이룹니다. 짝이 되는 세션쿠키와 세션파일은 세션아이디(SessionID) 라는 값이 동일합니다.
    - 세션아이디는 난수값이여서 중복될 확률이 극히 낮습니다.
    - 영희, 철수, 짱구가 들어오면 세 명은 모두 다른 세션아이디를 부여받습니다.
        
        ![세션아이디는 이렇게 생겼습니다.](Untitled%20525.png)
        
        세션아이디는 이렇게 생겼습니다.
        
- 사용자가 웹페이지에 접속하면, 브라우저에 세션쿠키를 저장하라고 명령하고, 서버에 짝이 되는 세션파일을 저장합니다.
- 세션파일은 시간이 지나면 자동으로 삭제됩니다.

# 세션을 이용한 인증 시스템

따라서 다음과 같은 과정으로 사용자를 인증합니다.

- 로그인에 성공하면, 사용자에게 쿠키를 주던 기존 방식과 달리, **모든 유저에게 세션쿠키를 주고, 짝이 되는 세션파일을 서버에 저장**함
- 사용자가 접속하면, 세션쿠키의 Session-ID 로 짝이 되는 세션파일을 찾은 후, 거기서 로그인 정보를 확인함
    - 세션쿠키는 짝이 되는 세션파일을 찾는 용도만 하고, 아무런 정보를 가지고 있지 않으므로 조작해도 소용이 없습니다.
    - 세션파일은 서버에 있으므로, 브라우저에서 조작할 수 없습니다.

대부분의 웹 언어는 세션기능을 함수로 제공합니다.

php 의 세션기능을 이용해 구현해보겠습니다.

계속